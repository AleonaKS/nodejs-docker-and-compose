{"ast":null,"code":"import{useState,useEffect}from\"react\";import{GoodCard}from\"../good-card\";import{Modal,Button}from\"../ui\";import cancelIcon from\"../../images/icons/cancel.svg\";import trashIcon from\"../../images/icons/trash-red.svg\";import{getOwnWishes,removeWish}from\"../../utils/api\";import styles from\"./wishlist-page.module.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const WishlistPage=_ref=>{let{extraClass=\"\"}=_ref;const[currentCardsId,setCurrentCardsId]=useState([]);const[data,setOwnWishes]=useState([]);const[isPopupOpen,setIsPopupOpen]=useState(false);useEffect(()=>{if(sessionStorage.getItem(\"auth_token\")){getOwnWishes().then(res=>{setOwnWishes(res);});}},[]);const handlePopupOpen=()=>{setIsPopupOpen(true);};const handlePopupClose=()=>{setIsPopupOpen(false);};const onCardClick=e=>{const card=e.target.tagName===\"ARTICLE\"?e.target:e.target.closest(\"article\");if(currentCardsId.indexOf(+card.id)!==-1){const arr=[...currentCardsId];arr.splice(currentCardsId.indexOf(+card.id),1);setCurrentCardsId(arr);}else{setCurrentCardsId([...currentCardsId,+card.id]);}};const handleRemoveSelection=()=>{isPopupOpen&&setIsPopupOpen(false);setCurrentCardsId([]);};const handleRemoveCards=()=>{Promise.all(currentCardsId.map(id=>removeWish(id).catch())).then(()=>{getOwnWishes().then(res=>{setCurrentCardsId([]);setOwnWishes(res);handlePopupClose();});});};return/*#__PURE__*/_jsxs(\"section\",{className:\"\".concat(styles.content,\" \").concat(extraClass),children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text text_type_h1 text_color_primary \".concat(styles.title),children:\"\\u041C\\u043E\\u0439 \\u0432\\u0438\\u0448\\u043B\\u0438\\u0441\\u0442\"}),currentCardsId.length?/*#__PURE__*/_jsxs(\"div\",{className:styles.menu,children:[/*#__PURE__*/_jsx(\"p\",{className:\"text text_type_button\",children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0442\\u043E, \\u0447\\u0442\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C | \".concat(currentCardsId.length,\" \\u0432\\u044B\\u0431\\u0440\\u0430\\u043D\\u043E\")}),/*#__PURE__*/_jsxs(\"div\",{className:styles.btn_box,children:[/*#__PURE__*/_jsxs(\"button\",{className:styles.btn,type:\"button\",onClick:handleRemoveSelection,children:[/*#__PURE__*/_jsx(\"img\",{src:cancelIcon,alt:\"\\u041A\\u043D\\u043E\\u043F\\u043A\\u0430 \\u0441\\u043D\\u044F\\u0442\\u0438\\u044F \\u0432\\u044B\\u0434\\u0435\\u043B\\u0435\\u043D\\u0438\\u044F.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text text_type_button ml-4\",children:\"\\u0421\\u043D\\u044F\\u0442\\u044C \\u0432\\u044B\\u0434\\u0435\\u043B\\u0435\\u043D\\u0438\\u0435\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:styles.btn,type:\"button\",onClick:handlePopupOpen,children:[/*#__PURE__*/_jsx(\"img\",{src:trashIcon,alt:\"\\u041A\\u043D\\u043E\\u043F\\u043A\\u0430 \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\\u0438\\u044F \\u043A\\u0430\\u0440\\u0442\\u043E\\u0447\\u043A\\u0438.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text text_type_button text_color_red-bg ml-4\",children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0432\\u044B\\u0431\\u0440\\u0430\\u043D\\u043D\\u043E\\u0435\"})]}),isPopupOpen&&/*#__PURE__*/_jsx(Modal,{onClose:handlePopupClose,extraClass:styles.modal,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.popup,children:[/*#__PURE__*/_jsx(\"p\",{className:\"text text_type_main mb-10\",children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0432\\u044B\\u0431\\u0440\\u0430\\u043D\\u043D\\u044B\\u0435 \\u043F\\u043E\\u0434\\u0430\\u0440\\u043A\\u0438?\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.popup_btn_box,children:[/*#__PURE__*/_jsx(Button,{type:\"button\",extraClass:styles.popup_btn,kind:\"support\",text:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\",onClick:handleRemoveSelection}),/*#__PURE__*/_jsx(Button,{type:\"button\",extraClass:styles.popup_btn,kind:\"secondary\",onClick:handleRemoveCards,text:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})]})})]})]}):\"\",/*#__PURE__*/_jsx(\"div\",{className:styles.cards_box,children:data.map(_ref2=>{let{id,price,image,name,raised}=_ref2;let withBorder=false;if(currentCardsId.indexOf(id)!==-1){withBorder=true;}return/*#__PURE__*/_jsx(GoodCard,{id:id,onClick:onCardClick,price:price,img:image,name:name,current:raised,extraClass:withBorder?styles.border:\"\"},id);})})]});};","map":{"version":3,"names":["useState","useEffect","GoodCard","Modal","Button","cancelIcon","trashIcon","getOwnWishes","removeWish","styles","jsx","_jsx","jsxs","_jsxs","WishlistPage","_ref","extraClass","currentCardsId","setCurrentCardsId","data","setOwnWishes","isPopupOpen","setIsPopupOpen","sessionStorage","getItem","then","res","handlePopupOpen","handlePopupClose","onCardClick","e","card","target","tagName","closest","indexOf","id","arr","splice","handleRemoveSelection","handleRemoveCards","Promise","all","map","catch","className","concat","content","children","title","length","menu","btn_box","btn","type","onClick","src","alt","onClose","modal","popup","popup_btn_box","popup_btn","kind","text","cards_box","_ref2","price","image","name","raised","withBorder","img","current","border"],"sources":["/Users/alenasenozenskaya/nodejs-docker-and-compose/frontend/src/components/wishlist-page/wishlist-page.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\n\nimport { GoodCard } from \"../good-card\";\n\nimport { Modal, Button } from \"../ui\";\n\nimport cancelIcon from \"../../images/icons/cancel.svg\";\nimport trashIcon from \"../../images/icons/trash-red.svg\";\n\nimport { getOwnWishes, removeWish } from \"../../utils/api\";\n\nimport styles from \"./wishlist-page.module.css\";\n\nexport const WishlistPage = ({ extraClass = \"\" }) => {\n  const [currentCardsId, setCurrentCardsId] = useState([]);\n  const [data, setOwnWishes] = useState([]);\n\n  const [isPopupOpen, setIsPopupOpen] = useState(false);\n\n  useEffect(() => {\n    if (sessionStorage.getItem(\"auth_token\")) {\n      getOwnWishes().then((res) => {\n        setOwnWishes(res);\n      });\n    }\n  }, []);\n\n  const handlePopupOpen = () => {\n    setIsPopupOpen(true);\n  };\n\n  const handlePopupClose = () => {\n    setIsPopupOpen(false);\n  };\n\n  const onCardClick = (e) => {\n    const card =\n      e.target.tagName === \"ARTICLE\" ? e.target : e.target.closest(\"article\");\n    if (currentCardsId.indexOf(+card.id) !== -1) {\n      const arr = [...currentCardsId];\n      arr.splice(currentCardsId.indexOf(+card.id), 1);\n      setCurrentCardsId(arr);\n    } else {\n      setCurrentCardsId([...currentCardsId, +card.id]);\n    }\n  };\n\n  const handleRemoveSelection = () => {\n    isPopupOpen && setIsPopupOpen(false);\n    setCurrentCardsId([]);\n  };\n\n  const handleRemoveCards = () => {\n    Promise.all(currentCardsId.map((id) => removeWish(id).catch())).then(() => {\n      getOwnWishes().then((res) => {\n        setCurrentCardsId([]);\n        setOwnWishes(res);\n        handlePopupClose();\n      });\n    });\n  };\n\n  return (\n    <section className={`${styles.content} ${extraClass}`}>\n      <h1 className={`text text_type_h1 text_color_primary ${styles.title}`}>\n        Мой вишлист\n      </h1>\n      {currentCardsId.length ? (\n        <div className={styles.menu}>\n          <p className=\"text text_type_button\">{`Выберите то, что хотите удалить | ${currentCardsId.length} выбрано`}</p>\n          <div className={styles.btn_box}>\n            <button\n              className={styles.btn}\n              type=\"button\"\n              onClick={handleRemoveSelection}\n            >\n              <img src={cancelIcon} alt=\"Кнопка снятия выделения.\" />\n              <p className=\"text text_type_button ml-4\">Снять выделение</p>\n            </button>\n            <button\n              className={styles.btn}\n              type=\"button\"\n              onClick={handlePopupOpen}\n            >\n              <img src={trashIcon} alt=\"Кнопка удаления карточки.\" />\n              <p className=\"text text_type_button text_color_red-bg ml-4\">\n                Удалить выбранное\n              </p>\n            </button>\n            {isPopupOpen && (\n              <Modal onClose={handlePopupClose} extraClass={styles.modal}>\n                <div className={styles.popup}>\n                  <p className=\"text text_type_main mb-10\">\n                    Удалить выбранные подарки?\n                  </p>\n                  <div className={styles.popup_btn_box}>\n                    <Button\n                      type=\"button\"\n                      extraClass={styles.popup_btn}\n                      kind=\"support\"\n                      text=\"Отмена\"\n                      onClick={handleRemoveSelection}\n                    />\n                    <Button\n                      type=\"button\"\n                      extraClass={styles.popup_btn}\n                      kind=\"secondary\"\n                      onClick={handleRemoveCards}\n                      text=\"Удалить\"\n                    />\n                  </div>\n                </div>\n              </Modal>\n            )}\n          </div>\n        </div>\n      ) : (\n        \"\"\n      )}\n      <div className={styles.cards_box}>\n        {data.map(({ id, price, image, name, raised }) => {\n          let withBorder = false;\n          if (currentCardsId.indexOf(id) !== -1) {\n            withBorder = true;\n          }\n          return (\n            <GoodCard\n              key={id}\n              id={id}\n              onClick={onCardClick}\n              price={price}\n              img={image}\n              name={name}\n              current={raised}\n              extraClass={withBorder ? styles.border : \"\"}\n            />\n          );\n        })}\n      </div>\n    </section>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}